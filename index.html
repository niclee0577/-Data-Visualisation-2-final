<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Global Cancer Information (2022)</title>
  <link rel="stylesheet" href="style.css"> 
  <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.4.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>
  <style>
  </style>
</head>
<body>
<div class="header">
  <h1 class="title">Global Cancer Mortality and Incidence Information (2022)</h1>
</div>

<div class="content">
    <h5 class="subtitle">* ASR = Age-Standardized Rate per 100,000 population</h5>
    <div id="combined" class="content_map"></div>
    <div id="dotchart" class="content_map"></div>
</div>
<div class="">
  <h6>Created by Nicholas Lee Jia Yang (32840594)</h6>
  <h6>
    Data Source:
      <a href="https://gco.iarc.fr/today/en/dataviz/maps-prevalence?mode=population&key=asr&populations=900&sort_by=value1&options_indicator=%5Bobject%20Object%5D_%5Bobject%20Object%5D&types=2">Global Cancer Observatory (IARC), World Health Organization.</a>
      and
      <a href="https://www.kaggle.com/datasets/shuvokumarbasak2030/cancer-rate-by-countries">Shuvo Kumar Basak, Kaggle</a>
  </h6>
</div>

  <script>
    var vlSpec = {
      $schema: "https://vega.github.io/schema/vega-lite/v6.json",
      config: {
        view: {
          stroke: null,
          facet: { spacing: 0 },
          padding: 0 
        },
      },
      autosize: { type: "fit", contains: "padding"},
      background: "#ecd9fffe", 
      params: [
        {
            name: "SelectedContinents",
            bind: {
                input: "select",
                options: ["Select All", "Asia", "Europe", "Africa", "North America", "Oceania", "South America"],
                multiple: true,
                size: 180,
                name: "Please Select Continents: ",
                
            },
            value: ["Select All"],   // default checke
        }
    ],

    vconcat: [
        // Choropleth Map
        {
          title: {
              text: [
                "Global Cancer Prevalence Cases (2022)"
              ],
              fontSize: 20,
              anchor: "start",
              color: "#3d0477",
              offset: 20,
            },

          width: 900,
          height: 500,
          projection: { 
            type: "equalEarth",
          },
          layer: [
          
          // Ocean Backgrond
          {
            data:{
              url: "ne_10m_ocean.json",
              format: {
                type: "topojson",
                feature: "ne_10m_ocean"
              }
            },
            mark: {type: "geoshape", fill:"skyblue" }
          },

          //graticule grid
          {
            data:{
              url: "ne_10m_graticules_30.json",
              format: {
                type: "topojson",
                feature: "ne_10m_graticules_30"
              }
            },
            mark: {
              type: "geoshape",
              fill: null,
              stroke: "lightgrey",
            },
            projection: {type: "equalEarth"}
          },

          // map outline  
          {
            data: {
              url: "https://vega.github.io/vega-datasets/data/world-110m.json",
              format: { type: "topojson", feature: "countries" }
            },
            mark: { type: "geoshape", fill: "darkgray", stroke: "black", strokeWidth: 0.5 }
          },
          
          // map with data
          {
            data: {
              url: "https://vega.github.io/vega-datasets/data/world-110m.json",
              format: { type: "topojson", feature: "countries" }
            },
            transform: [
              {
                lookup: "id",
                from: {
                  data: { url: "prevalence_mortality_updt.csv" },
                  key: "NumericCode",
                  fields: ["Country","PrevalenceCases", "Continent"]
                }
              },
              { filter: "indexof(SelectedContinents, 'Select All') >= 0 || indexof(SelectedContinents, datum.Continent) >= 0" }

            ],
            mark: { type: "geoshape", stroke: "black", strokeWidth: 1.5 },
            encoding: {
              color: {
                field: "PrevalenceCases",
                type: "quantitative",
                align: "left",
                scale: { scheme: "reds" },
                legend: { title: ["Prevalence Cases", "(ASR)"], titleFontSize: 16, labelFontSize: 15, offset: -140}    
              },
              tooltip: [
                { field: "Country", type: "nominal" },
                { field: "PrevalenceCases", type: "quantitative" }
              ]
            }
          }
          ]
        },
        {
        hconcat: [
        // text (map)  
        {
            title: {
              text: [
                "Global Cancer Prevalence Distribution (2022)"
              ],
              fontSize: 20,
              anchor: "start",
              color: "#3d0477",
              offset: 20,
              lineHeight: 23,
              dy: 100,
              dx: 0
          },
          width: 500,
          height: 300,
          data: { values: [{}] }, 
          mark: {
            type: "text",
            align: "left",
            baseline: "middle",
            fontSize: 18,
            color: "#3d0477",
            lineHeight: 23,
            limit: 500       
          },
          encoding: {
            x: { value: 0 }, 
            y: { value: 100 },
            text: {
              value:
                [
                "This visualization focus on the global variation of cancer ",
                "prevalence rates (ASR) across the continents. Develop ",
                "continents like Australia, the United States, and Canada ",
                "display highest prevalence rates (ASR) due to advance cancer ",
                "detection device. In constrast, many African and Southeast ",
                "Asian countries display low prevalence rates (ASR) due to ",
                "the limitation of advance technology to detect cancer rather ",
                "than low cancer burdens",
                " ",
                " ",
                " ",
              ]
            }
          }
        },
        
        // text map 2
        {
          title: {
            text: [
              "Regional Disparities in Cancer Prevalence",
            ],
            fontSize: 20,
            anchor: "start",
            color: "#3d0477",
            offset: 20,
            lineHeight: 23,

            dy: 100,
            dx: 100
          },
          width: 500,
          height: 100,
          data: { values: [{}] }, 
          mark: {
            type: "text",
            align: "left",
            baseline: "middle",
            fontSize: 18,
            color: "#3d0477",
            lineBreak: "auto",  
            lineHeight: 23,
            limit: 500         
          },
          encoding: {
            x: { value: 100 }, 
            y: { value: 100 },
            text: {
              value:
                [
                  "This map also highlight the different geographic patterns in ",
                  "cancer prevalence. North America and Europe regions have ", 
                  "higher prevalence which result in citizen having longer l",
                  "ife expectancy. Meanwhile, Asia and Affica region display ",
                  "lower rate which represent global inequities in healthcare ",
                  "resource and lack of cancer awareness amongs the nation.",
                  " ",
                  " ",
                  " "
              ]
            }
          },
        }
        ]
      },
        
        {
          hconcat: [
          // multi donut chart
        {
          vconcat: [  
        // incidence
        {
          data: { url: "multi_donutchart_in_check_updt.csv" },
          title: {
              text: [
                "Global Cancer Incidence and Mortaility Cases By ",
                "Gender and Continent (2022)"
              ],
              fontSize: 20,
              anchor: "start",
              color: "#3d0477",
              offset: 20,
            },
          columns: 3,
          
          facet: {
              field: "Continent",
              type: "nominal",
              bounds: "flush",
              columns: 3,

              header: {
                title: "Continent (Incidence)",
                titleFontSize: 16, 
                labelFontSize: 15,
                labelAlign: "center",
                labelOrient: "bottom", 
                titleOrient: "bottom",
                labelExpr: "indexof(SelectedContinents, 'Select All') >= 0 ? datum.label : (indexof(SelectedContinents, datum.value) >= 0 ? datum.label : '')"
              }
          },
        
          resolve: { scale: { x: "independent", y: "independent"} },    
          spec: {
            width: 140,
            height: 90,
            layer: [
              {
                mark: { type: "arc", innerRadius: 20 ,outerRadius: 35},
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",      // dark pink
                        "#120174"       // dark blue
                      ] 
                    },
                    legend: { title: "Gender", titleFontSize: 16, labelFontSize: 15},
                  },
                  opacity: {
                    condition: {
                      test: "indexof(SelectedContinents, datum.Continent) >= 0 || indexof(SelectedContinents, 'Select All') >= 0",
                      value: 1      
                    },
                    value: 0      
                  },
                  tooltip: [
                    {field: "Continent",type: "nominal"},
                    {field: "Gender",type: "nominal"},
                    {field: "Gender Percentage",type: "quantitative", format: ".1f"}
                ]
                }
              },
              {
                mark: { 
                  type: "text", 
                  radius: 50,
                  fontSize: 14,
                  fontWeight: "bold"
                },
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    stack: true,
    
                  },
                  text: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    format: ".1f"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",
                        "#120174"
                      ] 
                    },
                    legend: null
                  },
                  opacity: {
                    condition: {
                      test: "indexof(SelectedContinents, datum.Continent) >= 0 || indexof(SelectedContinents, 'Select All') >= 0",
                      value: 1
                    },
                    value: 0
                  },
                }
              }
              
            ]
          },
        },
        
        // mortality
        {
          data: { url: "multi_donutchart_mor_check_updt.csv" },
          columns: 3,
          
          facet: {
              field: "Continent",
              type: "nominal",
              bounds: "flush",
              header: {
                title: "Continent (Mortality)",
                titleFontSize: 16, 
                labelFontSize: 15,
                labelOrient: "bottom", 
                titleOrient: "bottom",
                labelExpr: "indexof(SelectedContinents, 'Select All') >= 0 ? datum.label : (indexof(SelectedContinents, datum.value) >= 0 ? datum.label : '')"
              }
          },
          spec: {
            width: 140,
            height: 100,
            autosize: { type: "none" },
            config: { view: { stroke: null } },
            resolve: { scale: { x: "independent", y: "independent" } },
            view: { continuousWidth: 600, continuousHeight: 300},
            layer: [
              {
                mark: { type: "arc", innerRadius: 20, outerRadius: 35},
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",      // dark pink
                        "#120174"       // dark blue
                      ] 
                    },
                    legend: { title: "Gender", titleFontSize: 16, labelFontSize: 15}
                  },
                  opacity: {
                    condition: {
                      test: "indexof(SelectedContinents, datum.Continent) >= 0 || indexof(SelectedContinents, 'Select All') >= 0",
                      value: 1
                    },
                    value: 0
                  },
                  tooltip: [
                    {field: "Continent",type: "nominal"},
                    {field: "Gender",type: "nominal"},
                    {field: "Gender Percentage",type: "quantitative", format: ".1f"}
                ]
                }
              },
              {
                mark: { 
                  type: "text", 
                  radius: 50,
                  fontSize: 14,
                  fontWeight: "bold"
                },
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    stack: true
                  },
                  text: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    format: ".1f"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",
                        "#120174"
                      ] 
                    },
                    legend: null
                  },
                  opacity: {
                    condition: {
                      test: "indexof(SelectedContinents, datum.Continent) >= 0 || indexof(SelectedContinents, 'Select All') >= 0",
                      value: 1
                    },
                    value: 0
                  },
                }
              }
              
            ]
          }
        }, 
      ],
    },
        // Slope Graph
        {
          width: 500,
          height: 600,
          title: {
              text: [
                "Global Cancer Incidence and Mortaility",
                "Rate By Continent (2022)"
              ],
              fontSize: 20,
              anchor: "start",
              color: "#3d0477",
              offset: 20,
              dy: 0,
              dx: 50
          },
          data: { url: "slope.csv" },
          config: {
            view: {
                stroke: null,
                fill: "#e5cefcfe",
                padding: 0 
            }
        },
          transform: [
            { filter: "indexof(SelectedContinents, 'Select All') >= 0 || indexof(SelectedContinents, datum.Continent) >= 0" }
          ],
          layer: [
            {
              mark: {
              type: "group",
              transform: [{ translate: [0, -100] }]
            },
            encoding: {
            x: { 
                field: "Measure",
                type: "nominal",
                sort: ["Incidence","Mortality"],
                axis: {
                    domain: false,
                    ticks: false, 
                    labels: true,
                    title: null,
                    labelAngle: 0,
                    labelAlign: "center",
                    labelBaseline: "top",
                    labelFontSize: 15,
                    orient: "top",
                    labelExpr: "datum.label == 'Incidence' ? 'Incidence ASR' : datum.label == 'Mortality' ? 'Mortality ASR' : datum.label" 
                }
            },
            y: { 
                field: "Cancer ASR rate",
                type: "quantitative",
                scale: { domain: [80, 300]},
                axis: null
            },
            color: {
              field: "Continent",
              type: "nominal",
              scale: {
                domain: ["Africa", "Asia", "Europe", "North America", "Oceania", "South America"],
                range: [
                  "#1f77b4",  // dark blue
                  "#BA1766",  // dark pink
                  "#020303",  // black
                  "#d62728",  // dark red
                  "#6D2494",  // dark purple
                  "#8c564b"   // brown
                ],

              },
              legend: { title: "Continent", titleFontSize: 16, labelFontSize: 15, orient: "right"}
            }
          },

          layer: [
            {
              mark: { type: "line", strokeWidth: 2 },
              encoding: {
                detail: { field: "Continent" },
                color: { field: "Continent", type: "nominal"}
              }
            },
            {
              mark: { type: "point", filled: true, size: 70},
              encoding: {
                detail: { field: "Continent" },
                color: { field: "Continent", type: "nominal" },
                tooltip: [
                    { field: "Continent", type: "nominal" },
                    { field: "Measure", type: "nominal" },
                    { field: "Cancer ASR rate", type: "quantitative" }
                ]
              }
            },                      
          {
              transform: [
                  {
                        calculate: "datum.Measure == 'Mortality' ? 10: -50",
                        as: "labelOffsetdx"
                    },
                    {
                        calculate: "datum.Measure == 'Mortality' ? (datum.Continent == 'Europe' ? -7: datum.Continent == 'Oceania' ? -6 : datum.Continent == 'North America' ? 9 : datum.Continent == 'South America' ? -10 : datum.Continent == 'Asia' ? -5 : datum.Continent == 'Africa' ? 22 : 0) : (datum.Continent == 'Europe' ? -5 : datum.Continent == 'Oceania' ? -5 : datum.Continent == 'North America' ? -10 : datum.Continent == 'South America' ? 0 : datum.Continent == 'Asia' ? -5 : datum.Continent == 'Africa' ? -5 : 0)",
                        as: "labelOffsetdy"
                    }
                ],
                mark: {
                    type: "text",
                    align: "left",
                    baseline: "middle",
                    dx: { expr: "datum.labelOffsetdx" },
                    dy: { expr: "datum.labelOffsetdy" },
                    fontSize: 17,
                    fontWeight: "bold"
                },
                encoding: {
                    x: { field: "Measure", type: "nominal" },
                    y: { field: "Cancer ASR rate", type: "quantitative" },
                    text: { field: "Cancer ASR rate", type: "quantitative", format: ".1f" },
                    color: { field: "Continent", type: "nominal" },
                    detail: { field: "Continent" },
                }
            },
            {
              mark: { 
                  type: "rule", 
                  stroke: "black", 
                  strokeWidth: 1,
              }, 
              encoding: { 
                  x: { datum: "Incidence",type: "nominal", band: 0.5,},
                  y: { datum: 80 },
                  y2: { datum: 290 }
                } 
            },
            {
                mark: { 
                    type: "rule", 
                    stroke: "black", 
                    strokeWidth: 1 
                }, 
            encoding: { 
                x: { datum: "Mortality", type: "nominal", band: 0.5 },
                y: { datum: 80 },
                y2: { datum: 290 },
            } 
        }
        ]
        },
      ]  
      }

    ],
    align: "each",
    resolve: {
      scale: { color: "independent" },
      legend: { color: "independent" }
    }
      },
      {
        hconcat: [
        // text for donut chart  
        {
            title: {
            text: [
              "Global Cancer Incidence and Mortaility Cases By ",
              "Gender and Continent (2022)"
            ],
            fontSize: 20,
            anchor: "start",
            color: "#3d0477",
            offset: 20,
            lineHeight: 23,
            dy: 70,
            dx: 0
          },
          width: 500,
          height: 300,
          data: { values: [{}] }, 
          mark: {
            type: "text",
            align: "left",
            baseline: "middle",
            fontSize: 18,
            color: "#3d0477",
            lineHeight: 23,
            limit: 500       
          },
          encoding: {
            x: { value: 0 }, 
            y: { value: 70 },
            text: {
              value:
                ["This visualization compares cancer incidence and mortality ",
                "by gender across continents in 2022. Overall, females show ",
                "slightly higher proportions of cancer cases in most regions, ",
                "particularly in Africa and North America. Mortality patterns ",
                "follow a similar trend, indicating consistent gender-based ",
                "outcomes. Oceania and South America exhibit nearly equal ",
                "distributions between males and females. The close alignment ",
                "between incidence and mortality suggests similar treatment ",
                "access and survival outcomes across genders globally.",
                " ",
                " ",
                " "
              ]
            }
          }
        },
        
        // text slope
        {
          
          title: {
            text: [
              "Global Cancer Incidence and Mortaility Rate By ",
              "Continent (2022)"
            ],
            fontSize: 20,
            anchor: "start",
            color: "#3d0477",
            offset: 20,
            lineHeight: 23,

            dy: 70,
            dx: 100
          },
          width: 500,
          height: 100,
          data: { values: [{}] }, 
          mark: {
            type: "text",
            align: "left",
            baseline: "middle",
            fontSize: 18,
            color: "#3d0477",
            lineBreak: "auto",  
            lineHeight: 23,
            limit: 500         
          },
          encoding: {
            x: { value: 100 }, 
            y: { value: 70 },
            text: {
              value:
                [
                  "The graph compares cancer Incidence ASR and Mortality ASR ",
                  "across continents. North America and Europe show high ", 
                  "incidence but much lower mortality, indicating strong ",
                  "healthcare and early detection. Africa and Asia have ",
                  "lower incidence yet higher mortality ratios, reflecting ",
                  "limited diagnosis and treatment access. The wide gaps in ",
                  "developed regions highlight effective healthcare systems, ",
                  "while narrow gaps in developing regions suggest ",
                  "underdiagnosis and poorer cancer management outcomes.",
                  " ",
                  " ",
                  " "
              ]
            }
          },
        }
        ]
      }
]
    };


    var v2Spec = {
      $schema: "https://vega.github.io/schema/vega-lite/v6.json",
      background: "#ecd9fffe",
      vconcat: [
      // dot plot  
      {
          data: { url: "dot_plot_data_check.csv" },
          width: 900,
          height: 600,
          title: {
              text: [
                "Cancer Incidence and Mortality Cases by Cancer Type (2022)"
              ],
              fontSize: 20,
              anchor: "start",
              color: "#3d0477",
              offset: 20
            },
          encoding: {
            y: {
              field: "Cancer Type",
              type: "nominal",
              axis: { title: "Cancer Type", labelFontSize: 16, titleFontSize: 15 },
              sort: { field: "Number of Cases", op: "max", order: "descending" }
            },
            x: {
              field: "Number of Cases",
              type: "quantitative",
              axis: { title: "Number of Cases (logarithm scale) ", labelFontSize: 16, titleFontSize: 15, format: ",", grid: false },
              scale: { type: "log" },
            }
          },

          layer: [
            {
              mark: { type: "line", strokeWidth: 2, color: "black" },
              encoding: { detail: { field: "Cancer Type" } }
            },
            {
              mark: { type: "point", filled: true, size: 70 },
              encoding: {
                color: {
                  field: "Type of Cases",
                  type: "nominal",
                  scale: {
                    domain: ["Incidence", "Mortality"],
                    range: [
                      "#24524A", 
                      "#AD1D00"
                    ]
                  },
                  legend: { title: "Type of Cases", titleFontSize: 16, labelFontSize: 15, labels: ["Incidence, Mortality"], offset: -30}
                },
                tooltip: [
                  { field: "Cancer Type", type: "nominal", title: "Cancer type" },
                  { field: "Type of Cases", type: "nominal", title: "Type of Cases" },
                  { field: "Number of Cases", type: "quantitative", title: "Number of Cases", format: ","}
                ]
              }
            },
          ]
        },
        {
        hconcat: [
        // text dot chart 1
        {
            title: {
            text: [
              "Cancer Incidence and Mortality Differences."
            ],
            fontSize: 20,
            anchor: "start",
            color: "#3d0477",
            offset: 20,
            lineHeight: 23,
            dy: 100,
            dx: 0
          },
          width: 450,
          height: 300,
          data: { values: [{}] }, 
          mark: {
            type: "text",
            align: "left",
            baseline: "middle",
            fontSize: 18,
            color: "#3d0477",
            lineHeight: 23,
            limit: 500       
          },
          encoding: {
            x: { value: -150 }, 
            y: { value: 100 },
            text: {
              value:
                ["This visualization compares the gaps between cancer ",
                "incidence and mortality by gender across continents in 2022. ",
                "In general, Breast and prostate cancers have high incidence ",
                "but lower mortality due to better treatment and detection ",
                "process. While, pancreatic, liver, and lung cancers display ",
                "smaller gaps which indicates that the cancer type have poor ",
                "surviral rate."
              ]
            }
          }
        },
        
        // text dot chart 2
        {
          
          title: {
            text: [
              "Detection and Healthcare Variation by Cancer Type"
            ],
            fontSize: 20,
            anchor: "start",
            color: "#3d0477",
            offset: 20,
            lineHeight: 23,
            dy: 100,
            dx: 0
          },
          width: 200,
          height: 100,
          data: { values: [{}] }, 
          mark: {
            type: "text",
            align: "left",
            baseline: "middle",
            fontSize: 18,
            color: "#3d0477",
            lineBreak: "auto",  
            lineHeight: 23,
            limit: 500         
          },
          encoding: {
            x: { value: 0 }, 
            y: { value: 100 },
            text: {
              value:
                [
                  "The cancer type such as breast and colorectal cancers ",
                  "provides a large incidence rates which highlight the ",
                  "advance screening program for a develop country. In contrast ",
                  "cancer like liver and cervical cancer display high mortality rate ",
                  "due to the lack of proper treatment process to survive these ",
                  "cancer Therefore, this highlight the global inequalities in ",
                  "healthcare infrastructure and awareness.",
                  " ",
                  " ",
                  " "
              ]
            }
          },
        }
        ]
      }
        ]
    }
    vegaEmbed("#combined", vlSpec, { actions: false });
    vegaEmbed("#dotchart", v2Spec, { actions: false });
  </script>
</body>
</html>