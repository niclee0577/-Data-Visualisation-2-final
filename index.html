<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Global Cancer Information (2022)</title>
  <link rel="stylesheet" href="style.css"> 
  <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.4.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>
  <style>
  </style>
</head>
<body>
<div class="header">
  <h1 class="title">Global Cancer Mortality and Incidence Information (2022)</h1>
</div>

<div class="content">
    <h5 class="subtitle">* ASR = Age-Standardized Rate per 100,000 population</h5>
    <div id="combined" class="content_map"></div>
    <div id="dotchart" class="content_map"></div>

</div>

  <script>
    var vlSpec = {
      $schema: "https://vega.github.io/schema/vega-lite/v6.json",
      config: {
        view: {
          stroke: null,
          facet: { spacing: 0 },
          padding: 0 
        },
      },
      autosize: { type: "fit", contains: "padding"},
      
      background: "#e5cefcfe", 
      params: [
        {
            name: "SelectedContinents",
            bind: {
                input: "select",
                options: ["Select All", "Asia", "Europe", "Africa", "North America", "Oceania", "South America"],
                multiple: true,
                size: 180,
                name: "Please Select Continents: ",
                
            },
            value: ["Select All"],   // default checke
        }
    ],

    vconcat: [
        // Choropleth Map
        {
          title: {
            text: "Global Cancer Prevalence Cases (2022)",
            fontSize: 20,
            anchor: "start",
            color: "#3d0477",
            offset: 30,
            subtitle: [
              " ",  
              "This map shows global cancer prevalence cases ASR (2022). Darker red regions, such as North America, Europe, and Australia, have the highest prevalence rates ", 
              "(over 400 per 100,000), reflecting aging populations and better detection. Africa and parts of Asia show lower prevalence, likely due to underdiagnosis and ",
              "limited healthcare access. Overall, developed regions report more cancer cases, while developing regions face underreporting and data limitations despite ",
              "growing cancer burdens."
            ],
            subtitleFontSize: 14,
            subtitleColor: "#3d0477"
          },
          width: 900,
          height: 500,
          projection: { 
            type: "equalEarth", 
          },

          layer: [
            {
              data: {
                url: "https://vega.github.io/vega-datasets/data/world-110m.json",
                format: { type: "topojson", feature: "countries" }
              },
              mark: { type: "geoshape", fill: "darkgray", stroke: "black", strokeWidth: 0.5 }
            },
            {
              data: {
                url: "https://vega.github.io/vega-datasets/data/world-110m.json",
                format: { type: "topojson", feature: "countries" }
              },
              transform: [
                {
                  lookup: "id",
                  from: {
                    data: { url: "prevalence_mortality_updt.csv" },
                    key: "NumericCode",
                    fields: ["Country","PrevalenceCases", "Continent"]
                  }
                },
                { filter: "indexof(SelectedContinents, 'Select All') >= 0 || indexof(SelectedContinents, datum.Continent) >= 0" }

              ],
              mark: { type: "geoshape", stroke: "black", strokeWidth: 1.5 },
              encoding: {
                color: {
                  field: "PrevalenceCases",
                  type: "quantitative",
                  align: "left",
                  scale: { scheme: "reds" },
                  legend: { title: ["Prevalence Cases", "(ASR)"], titleFontSize: 13, labelFontSize: 11}
                },
                tooltip: [
                  { field: "Country", type: "nominal" },
                  { field: "PrevalenceCases", type: "quantitative" }
                ]
              }
            }
          ]
        },

        {
          hconcat: [
          // text  
          {
            title: {
              text: [
                "Global Cancer Incidence and Mortaility",
                "Rate By Continent (2022)"
              ],
              fontSize: 20,
              anchor: "start",
              color: "#3d0477",
              offset: 20,
              dy: 350,
              dx: 0
            },
            width: 500,
            height: 100,
            data: { values: [{}] }, 
            mark: {
              type: "text",
              align: "left",
              baseline: "middle",
              fontSize: 14,
              color: "#3d0477",
              lineBreak: "auto",  
              lineHeight: 18,
              limit: 500         
            },
            encoding: {
              x: { value: 0 }, 
              y: { value: 350 },
              text: {
                value:
                  [
                    "The graph compares cancer Incidence ASR and Mortality ASR ",
                    "across continents. North America and Europe show high incidence ", 
                    "but much lower mortality, indicating strong healthcare and early ",
                    "detection. Africa and Asia have lower incidence yet higher mortality ",
                    "ratios, reflecting limited diagnosis and treatment access. The wide ",
                    "gaps in developed regions highlight effective healthcare systems, ",
                    "while narrow gaps in developing regions suggest underdiagnosis and ",
                    "poorer cancer management outcomes."
                ]
              }
            }
    

          },
        // Slope Graph
        {
          width: 400,
          height: 700,
          data: { url: "slope.csv" },
          config: {
            view: {
                stroke: null,
                fill: "#e5cefcfe"
            }
        },
          transform: [
            { filter: "indexof(SelectedContinents, 'Select All') >= 0 || indexof(SelectedContinents, datum.Continent) >= 0" }
          ],
           encoding: {
            x: { 
                field: "Measure",
                type: "nominal",
                sort: ["Incidence","Mortality"],
                scale: { paddingInner: 0.1, paddingOuter: 0.01 },
                axis: {
                    domain: false,
                    ticks: false, 
                    labels: true,
                    title: null,
                    labelAngle: 0,
                    labelAlign: "center",
                    labelBaseline: "top",
                    labelFontSize: 15,
                    orient: "top",
                    dy: 10,
                    labelExpr: "datum.label == 'Incidence' ? 'Incidence ASR' : datum.label == 'Mortality' ? 'Mortality ASR' : datum.label" 
                }
            },
            y: { 
                field: "Cancer ASR rate",
                type: "quantitative",
                scale: { domain: [80, 300]},
                axis: null
            },
            color: {
              field: "Continent",
              type: "nominal",
              scale: {
                domain: ["Africa", "Asia", "Europe", "North America", "Oceania", "South America"],
                range: [
                  "#1f77b4",  // dark blue
                  "#BA1766",  // dark pink
                  "#020303",  // black
                  "#d62728",  // dark red
                  "#6D2494",  // dark purple
                  "#8c564b"   // brown
                ],

              },
              legend: { title: "Continent", titleFontSize: 13, labelFontSize: 11, orient: "right"}
            }
          },

          layer: [
            {
              mark: { type: "line", strokeWidth: 2 },
              encoding: {
                detail: { field: "Continent" },
                color: { field: "Continent", type: "nominal"}
              }
            },
            {
              mark: { type: "point", filled: true, size: 70},
              encoding: {
                detail: { field: "Continent" },
                color: { field: "Continent", type: "nominal" },
                tooltip: [
                    { field: "Continent", type: "nominal" },
                    { field: "Measure", type: "nominal" },
                    { field: "Cancer ASR rate", type: "quantitative" }
                ]
              }
            },                      
          {
              transform: [
                  {
                        calculate: "datum.Measure == 'Mortality' ? 5: -45",
                        as: "labelOffsetdx"
                    },
                    {
                        calculate: "datum.Measure == 'Mortality' ? (datum.Continent == 'Europe' ? -5: datum.Continent == 'Oceania' ? -5 : datum.Continent == 'North America' ? 10 : datum.Continent == 'South America' ? -5 : datum.Continent == 'Asia' ? -3 : datum.Continent == 'Africa' ? 20 : 0) : (datum.Continent == 'Europe' ? -5 : datum.Continent == 'Oceania' ? -5 : datum.Continent == 'North America' ? -10 : datum.Continent == 'South America' ? -5 : datum.Continent == 'Asia' ? -5 : datum.Continent == 'Africa' ? -5 : 0)",
                        as: "labelOffsetdy"
                    }
                ],
                mark: {
                    type: "text",
                    align: "left",
                    baseline: "middle",
                    dx: { expr: "datum.labelOffsetdx" },
                    dy: { expr: "datum.labelOffsetdy" },
                    fontSize: 15,
                    fontWeight: "bold"
                },
                encoding: {
                    x: { field: "Measure", type: "nominal" },
                    y: { field: "Cancer ASR rate", type: "quantitative" },
                    text: { field: "Cancer ASR rate", type: "quantitative", format: ".1f" },
                    color: { field: "Continent", type: "nominal" },
                    detail: { field: "Continent" },
                }
            },
            {
              mark: { 
                  type: "rule", 
                  stroke: "black", 
                  strokeWidth: 1,
              }, 
              encoding: { 
                  x: { datum: "Incidence",type: "nominal", band: 0.5,},
                  y: { datum: 80 },
                  y2: { datum: 290 }
                } 
            },
            {
                mark: { 
                    type: "rule", 
                    stroke: "black", 
                    strokeWidth: 1 
                }, 
            encoding: { 
                x: { datum: "Mortality", type: "nominal", band: 0.5,  },
                y: { datum: 80 },
                y2: { datum: 290 }
            } 
        }
        ]
        },
        
    ]
      },
        // multi donut chart
        {
          hconcat: [
        {
          vconcat: [
        
        // incidence
        {
          data: { url: "multi_donutchart_in_check_updt.csv" },
          transform: [
            { filter: "indexof(SelectedContinents, 'Select All') >= 0 || indexof(SelectedContinents, datum.Continent) >= 0" }
          ],
          columns: 3,
          spacing: 0,
          dx: 100,
          
          facet: {
              field: "Continent",
              type: "nominal",
              header: {
                title: "Continent (Incidence)",
                titleFontSize: 14, 
                labelFontSize: 13,
                labelAlign: "center"   
              }
          },
          spec: {
            width: 140,
            height: 130,
            config: { view: { stroke: "red", padding: 0 } },
            layer: [
              {
                mark: { type: "arc", innerRadius: 20 ,outerRadius: 35},
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",      // dark pink
                        "#120174"       // dark blue
                      ] 
                    },
                    legend: { title: "Gender", titleFontSize: 13, labelFontSize: 11, orient: "top"}
                  },
                  tooltip: [
                    {field: "Continent",type: "nominal"},
                    {field: "Gender",type: "nominal"},
                    {field: "Gender Percentage",type: "quantitative", format: ".1f"}
                ]
                }
              },
              {
                mark: { 
                  type: "text", 
                  radius: 50,
                  fontSize: 14,
                  fontWeight: "bold"
                },
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    stack: true,
    
                  },
                  text: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    format: ".1f"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",
                        "#120174"
                      ] 
                    },
                    legend: null
                  }
                }
              }
              
            ]
          }
        },
        
        // mortality
        {
          data: { url: "multi_donutchart_mor_check_updt.csv" },
          transform: [
            { filter: "indexof(SelectedContinents, 'Select All') >= 0 || indexof(SelectedContinents, datum.Continent) >= 0" }
          ],
          columns: 3,
          spacing: 0,
          
          facet: {
              field: "Continent",
              type: "nominal",
              header: {
                title: "Continent (Mortality)",
                titleFontSize: 14, 
                labelFontSize: 13,
              }
          },
          spec: {
            width: 140,
            height: 130,
            layer: [
              {
                mark: { type: "arc", innerRadius: 20, outerRadius: 35},
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",      // dark pink
                        "#120174"       // dark blue
                      ] 
                    },
                    legend: { title: "Gender", titleFontSize: 17, labelFontSize: 15 }
                  },
                  tooltip: [
                    {field: "Continent",type: "nominal"},
                    {field: "Gender",type: "nominal"},
                    {field: "Gender Percentage",type: "quantitative", format: ".1f"}
                ]
                }
              },
              {
                mark: { 
                  type: "text", 
                  radius: 50,
                  fontSize: 14,
                  fontWeight: "bold"
                },
                encoding: {
                  theta: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    stack: true
                  },
                  text: {
                    field: "Gender Percentage",
                    type: "quantitative",
                    format: ".1f"
                  },
                  color: {
                    field: "Gender",
                    type: "nominal",
                    scale: { 
                      range: [
                        "#B80065",
                        "#120174"
                      ] 
                    },
                    legend: null
                  }
                }
              }
              
            ]
          }
        }, 
      
      ]
    
    },
    // text
    {
      title: {
        text: [
          "Global Cancer Incidence and Mortaility",
          "Cases By Gender and Continent (2022)"
        ],
        fontSize: 20,
        anchor: "start",
        color: "#3d0477",
        offset: 20,
        dy: 200,
        dx: 100
      },
      width: 500,
      height: 100,
      data: { values: [{}] }, 
      mark: {
        type: "text",
        align: "left",
        baseline: "middle",
        fontSize: 14,
        color: "#3d0477",
        lineBreak: "auto",  
        lineHeight: 18,
        limit: 400         
      },
      encoding: {
        x: { value: 100 }, 
        y: { value: 200 },
        text: {
          value:
            ["This visualization compares cancer incidence and mortality ",
            "by gender across continents in 2022. Overall, females show ",
            "slightly higher proportions of cancer cases in most regions, ",
            "particularly in Africa and North America. Mortality patterns ",
            "follow a similar trend, indicating consistent gender-based ",
            "outcomes. Oceania and South America exhibit nearly equal ",
            "distributions between males and females. The close alignment ",
            "between incidence and mortality suggests similar treatment ",
            "access and survival outcomes across genders globally."
          ]
        }
      }
    }
  ],
  autosize: { type: "fit", contains: "content" }
  }
      
]
    };


    var v2Spec = {
      $schema: "https://vega.github.io/schema/vega-lite/v6.json",
      background: "#e5cefcfe",
      hconcat: [
        // text
      {
        title: {
          text: ["Cancer Incidence and Mortality Cases", "by Cancer Type (2022)"],
          fontSize: 20,
          anchor: "start",
          color: "#3d0477",
          offset: 20,
          dy: 300
        },
        width: 500,
        height: 600,
        data: { values: [{}] }, 
        mark: {
          type: "text",
          align: "left",
          baseline: "middle",
          fontSize: 14,
          color: "#3d0477",
          lineBreak: "auto",  
          lineHeight: 18,
          limit: 500         
        },
        encoding: {
          x: { value: 0 }, 
          y: { value: 300 },
          text: {
            value:
              ["This visualization compares global cancer incidence and ",
              "mortality in 2022. Lung, breast, and colorectal cancers  ",
              "have the highest overall burden, while thyroid and prostate",
              "show better survival outcomes. The shorter gaps between ",
              "incidence and mortality in liver and pancreatic cancers ",
              "indicate poorer prognoses globally."
            ]
          }
        }
      },

        {
          data: { url: "dot_plot_data_check.csv" },
          width: 240,
          height: 600,
          encoding: {
            y: {
              field: "Cancer Type",
              type: "nominal",
              axis: { title: "Cancer Type", labelFontSize: 11, titleFontSize: 13 },
              sort: { field: "Number of Cases", op: "max", order: "descending" }
            },
            x: {
              field: "Number of Cases",
              type: "quantitative",
              axis: { title: "Number of Cases", labelFontSize: 11, titleFontSize: 13, format: ",", grid: false },
              scale: { type: "log" },
            }
          },

          layer: [
            {
              mark: { type: "line", strokeWidth: 2, color: "black" },
              encoding: { detail: { field: "Cancer Type" } }
            },
            {
              mark: { type: "point", filled: true, size: 70 },
              encoding: {
                color: {
                  field: "Type of Cases",
                  type: "nominal",
                  scale: {
                    domain: ["Incidence", "Mortality"],
                    range: ["#1D0075", "#74010F"]
                  },
                  legend: { title: "Type of Cases", titleFontSize: 13, labelFontSize: 11, labels: ["Incidence, Mortality"]}
                },
                tooltip: [
                  { field: "Cancer Type", type: "nominal", title: "Cancer type" },
                  { field: "Type of Cases", type: "nominal", title: "Type of Cases" },
                  { field: "Number of Cases", type: "quantitative", title: "Number of Cases", format: "," }
                ]
              }
            },
          ]
        }
        ]
    }
    vegaEmbed("#combined", vlSpec, { actions: false });
    vegaEmbed("#dotchart", v2Spec, { actions: false });
  </script>
</body>
</html>