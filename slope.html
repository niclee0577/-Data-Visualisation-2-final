<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
    <title>Global Cancer information (2022)</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.4.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>
    <link rel="stylesheet" href="style.css">

     <style media="screen">
      .vega-actions a {
        margin-right: 5px;
      }
    </style>

 </head>
  <body>
    <h2 class="title">Global Cancer Incidence and mortality rate (2022)</h2>
    
    <div class="slope-graph">
        <div id="slope"></div>
    </div>
    <script>
        var vlSpec = {
        $schema: "https://vega.github.io/schema/vega-lite/v6.json",
        autosize: { type: "pad", contains: "padding"},
        width: 700,
        height: auto,
        data: { url: "slope.csv" },
        transform: [
            { joinaggregate: [
                { op: "max", field: "Cancer ASR rate", as: "incidence" }
            ],
            groupby: ["Country"]
            },
            { window: [
                { op: "rank", field: "incidence", as: "rank" }
            ],
            sort: [{ field: "incidence", order: "descending" }]
            },
            { filter: "datum.rank <= 10" }
            
        ],
        encoding: {
            x: { 
                field: "Measure",
                type: "nominal",
                sort: ["Incidence","Mortality"],
                axis: { 
                    domain: false,
                    ticks: false, 
                    labels: true,
                    labelFontSize: 12,
                    labelPadding: 20,
                    title: null
                }
            },
            y: { 
                field: "Cancer ASR rate",
                type: "quantitative",
                axis: null           
            }
        },
        layer: [
            {
            mark: { 
                type: "line", 
                strokeWidth: 1,
                opacity: 0.3 
            },
            encoding: {
                detail: {field: "Country"},
                color: { 
                    field: "Country", 
                    type: "nominal", 
                    legend: {
                        title: "Country",
                        orient: "right",
                        labelFontSize: 10,
                        symbolSize: 100
                    }
                }
            }
        },
        {
            mark: { 
                type: "point", 
                filled: true, 
                size: 30,
                opacity: 0.6
            },
            encoding: {
                detail: {field: "Country"},
                color: { 
                    field: "Country", 
                    type: "nominal", 
                    legend: {
                        title: "Country",
                        orient: "right",
                        labelFontSize: 10,
                        symbolSize: 100
                    }
                }
            }
        },
        {
            transform: [{filter: "datum.Measure == 'Incidence'"}],
            mark: { 
                type: "text", 
                align: "right",
                dx: -5,
                fontSize: 10,
            },
            encoding: {
                y: { 
                    field: "Cancer ASR rate",
                    type: "quantitative"
                },
                color: {value: "black"},
            }
        },
        {
            transform: [{filter: "datum.Measure == 'Mortality'"}],
            mark: { 
                type: "text", 
                align: "left",
                dx: 5,
                fontSize: 10,
            },
            encoding: {
                y: { 
                    field: "Cancer ASR rate",
                    type: "quantitative"
                },
                color: {value: "black"}
            }
        }
    ]
    };
  
        vegaEmbed("#slope", vlSpec, { actions: false });
     </script>
  </body>
</html>