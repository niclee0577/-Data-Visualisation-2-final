<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
    <title>Global Cancer information (2022)</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.4.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>
    <link rel="stylesheet" href="style.css">

     <style media="screen">
      .vega-actions a {
        margin-right: 5px;
      }
    </style>

 </head>
  <body>
    <h2 class="title">New Global Cancer Incidence And Mortality Rate </h2>
    
    <div class="slope-graph">
        <div id="slope"></div>
    </div>
    <script>
        var vlSpec = {
        $schema: "https://vega.github.io/schema/vega-lite/v6.json",
        autosize: { type: "pad", contains: "padding"},
        width: 700,
        height: 400,
        data: { url: "slope.csv" },
        config: {
            view: { stroke: "transparent" }   
        },
        background: "#e5cefcfe",
        transform: [
            { joinaggregate: [
                { op: "max", field: "Cancer ASR rate", as: "incidence" }
            ],
            groupby: ["Country"]
            },
            { window: [
                { op: "rank", field: "incidence", as: "rank" }
            ],
            sort: [{ field: "incidence", order: "descending" }]
            },
            { filter: "datum.rank <= 10" }
            
        ],
        encoding: {
            x: { 
                field: "Measure",
                type: "nominal",
                sort: ["Incidence","Mortality"],
                scale: { paddingInner: 0, paddingOuter: 0, align: "left" },
                axis: { 
                    domain: false,
                    ticks: false, 
                    labels: true,
                    labelFontSize: 12,
                    labelPadding: 20,
                    title: null,
                    labelAngle: 0,
                    labelAlign: "center",
                    labelBaseline: "top"
                }
            },
            y: { 
                field: "Cancer ASR rate",
                type: "quantitative",
                axis: { 
                    title: "Age-Standardized Rate (per 100,000 population)",
                    grid: true,          // horizontal gridlines
                    tickCount: 6,        // number of ticks (adjust as needed)
                    labelFontSize: 11,
                    labelColor: "black",
                    gridColor: "grey",
                    ticksColor: "grey",
                    gridDash: [4,4],
                }
            }
        },
        layer: [
            {
            mark: { 
                type: "line", 
                strokeWidth: 2,
            },
            encoding: {
                detail: {field: "Country"},
                color: { 
                    field: "Country", 
                    type: "nominal",
                    legend: {
                        title: "Country",
                        orient: "right",
                        labelFontSize: 10,
                        symbolSize: 100
                    }
                }
            }
        },
        {
            mark: { 
                type: "point", 
                filled: true,
            },
            encoding: {
                detail: {field: "Country"},
                color: { 
                    field: "Country", 
                    type: "nominal", 
                    legend: {
                        title: "Country",
                        orient: "right",
                        labelFontSize: 10,
                        symbolSize: 100
                    }
                }
            }
        },
        {
            mark: { type: "rule", stroke: "#888", strokeWidth: 0.5, opacity: 0.5 },
            encoding: { x: { datum: "Incidence" } }
        },
        {
            mark: { type: "rule", stroke: "#888", strokeWidth: 0.5, opacity: 0.5 },
            encoding: { x: { datum: "Mortality" } }
        }
    ]
    };
        vegaEmbed("#slope", vlSpec, { actions: false });
     </script>
  </body>
</html>